<template name="studentLandingPage">
	<div class="row">
		<div class="col-sm-12">
			{{#if pendingPayment}}
				<p class="alert alert-warning">This term school fees payment is pending &nbsp;&nbsp;<a href="{{pathFor 'stNewPayment'}}" class="btn btn-success btn-sm">Pay now</a></p>
			{{/if}}
		</div>
		<div class="col-sm-12 col-md-6 col-lg-3">
			<div class="card">
				<div class="card-body">
					<h4 class="card-title text-danger">
						{{allResults}}
						<span class="fa fa-check fa-2x float-right"></span>
					</h4>
					<p class="card-text">
						Results
					</p>
				</div>
			</div>
		</div>
		<!-- card break -->
		<div class="col-sm-12 col-md-6 col-lg-3">
			<div class="card">
				<div class="card-body">
					<h4 class="card-title text-info">
						{{assignment.total}}
						<span class="fa fa-adn fa-2x float-right"></span>
					</h4>
					<p class="card-text">
						Assignments
					</p>
				</div>
			</div>
		</div>
		<!-- card break -->
		<div class="col-sm-12 col-md-6 col-lg-3">
			<div class="card">
				<div class="card-body">
					<p class="card-text">
						<span class="text-info">Assignments</span><br/>
						<span class="badge badge-info">Answered: {{assignment.answered}}</span>
						<span class="badge badge-success">Marked: {{assignment.answeredAndMarked}}</span>
						<span class="badge badge-danger">Unanswered: {{assignment.unanswered}}</span>
					</p>
				</div>
			</div>
		</div>
		<div class="col-sm-12 col-md-6 col-lg-3">
			<div class="card">
				<div class="card-body">
					<h4 class="card-title text-danger">
						{{allPayments}}
						<span class="fa fa-money fa-2x float-right"></span>
					</h4>
					<p class="card-text">
						Payments
					</p>
				</div>
			</div>
		</div>
		<!-- card break -->
	</div><br/>
	<div class="row">
		<div class="col-sm-8">
			<div class="card">
				<div class="card-body">
					<h4 class="card-title text-info">
						NOTIFICATION
					</h4>
					<div class="card-text notification">
						<article>
							<p>{{{setting.notification}}}</p>
						</article>
					</div>
				</div>
			</div>
		</div>

		<div class="col-sm-4">
			<div class="card">
				<div class="card-body">
					<div class="card-title">
						<h3 class="text-center text-secondary">Current</h3>
					</div>
					<div class="card-text">
						<h4 class="text-info">
							Session: {{setting.session}}
						</h4>
						<h4 class="text-info">
							Term: {{termSuffix setting.term}}
						</h4>
					</div>
				</div>
			</div>
		</div>
	</div><br/>
	<!-- end second row -->
	<div class="row">
		<div class="col-sm-7">
			<div class="card">
				<div class="card-body">
					<h4 class="card-title text-info">
						My Subjects
					</h4>
					<div class="card-text">
					
					</div>
				</div>
			</div>
		</div>
		<div class="col-sm-5">
			<div class="card">
				<div class="card-body">
					<div class="card-title">
						<h4 class="text-center text-danger">Recent Activities</h4>
					</div>
					<div class="card-text">
						{{#each log}}
							<strong>*</strong> <span>{{name}} {{action}}</span> <span class="badge badge-secondary">@{{dateFormat time}}</span><br/>
						{{/each}}
						<a href="{{pathFor 'stLogs'}}">See more...</a>
					</div>
				</div>
			</div>
		</div>
	</div><br/>
	<!-- end third row -->
	<div class="row">
		<div class="col-sm-12">
			<div class="card text-white bg-info">
				<div class="card-body">
					<div class="card-title">
						<h3 class="text-center">
							Your Performance Analysis
						</h3>
					</div>
					<div title="coming soon" class="card-text text-center">
						<span class="fa fa-bar-chart-o fa-5x"></span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end last row -->
</template>
<template name="studentProfile">
	<div class="row">
		{{#with currentStudent}}
		<div class="col-sm-12">
			<h5>{{lastName}} {{firstName}} Profile</h5><hr/>
			<table class="table table-responsive table-striped">
					<thead>
						<tr>
							<th colspan="2" class="table-info">Admission Data</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<th>Last Name</th><td>{{lastName}}</td>
						</tr>
						<tr>
							<th>First Name</th><td>{{firstName}}</td>
						</tr>
						<tr>
							<th>Other Name</th><td>{{otherName}}</td>
						</tr>
						<tr>	
							<th>Gender</th> <td>{{gender}}</td>
						</tr>
						<tr>
							<th>Class</th>	<td>{{currentClass}}</td>
						</tr>
						<tr>
							<th>Student ID</th> <td>{{studentId}}</td>
						</tr>
						<tr>
							<th>Date of Birth</th> <td>{{dayMonthYear dob}}</td>
						</tr>
						<tr>
							<th colspan="2" class="table-info">Parent/Guardian</th>
						</tr>
						<tr>
							<th>Name</th>
							<td>{{parentOrGuardian.name}}</td>
						</tr>
						<tr>
							<th>Address</th>
							<td>{{parentOrGuardian.address}}</td>
						</tr>
						<tr>
							<th>Contact Number</th>
							<td>{{parentOrGuardian.phone}}</td>
						</tr>
					</tbody>
			</table>
				<!-- Other Information -->
			<table class="table table-responsive table-striped">
				<thead>
					<tr>
						<th colspan="2" class="table-info">Personal Information</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<th>Contact Number</th> <td>{{phone}}</td>
					</tr>
					<tr>
						<th>Email</th> <td>{{email}}</td>
					</tr>
					
					<tr>
						<th>State</th> <td>{{state}} State</td>
					</tr>
					<tr>
						<th>Town</th> <td>{{town}}</td>
					</tr>
					<tr>
						<th>Present Address</th> <td>{{presentAddress}}</td>
					</tr>
					<tr>
						<th>Home Address</th> <td>{{homeAddress}}</td>
					</tr>
					<tr>
						<th>Hobbies</th> <td>{{hobby}}</td>
					</tr>
					<tr>
						<th>Club and Society</th> <td>{{club}}</td>
					</tr>
					<tr>
						<th colspan="2" class="table-info">Next of Kin</th>
					</tr>
					<tr>
						<th>Name</th> <td>{{nok.name}}</td>
					</tr>
					<tr>
						<th>Address</th> <td>{{nok.address}}</td>
					
					</tr>
					
					<tr>
						<th>Contact</th> <td>{{nok.phone}}</td>
					</tr>
					<tr>
						<th>Relationship</th> <td>{{nok.relationship}}</td>
					</tr>
					<tr>
						<th colspan="2" class="table-info">Medical History</th>
					</tr>
					<tr>
						<th>Blood Group</th>
						<td>{{medicalHistory.bloodGroup}}</td>
					</tr>
					<tr>
						<th>Genotype</th>
						<td>{{medicalHistory.genotype}}</td>
					</tr>
					<tr>
						<th>Blood Group</th>
						<td>{{medicalHistory.medicalCondition}}</td>
					</tr>
				</tbody>
				<tfoot>
					<a href="{{pathFor 'editStProfile'}}" class="btn btn-primary btn-sm">Edit profile</a>
				</tfoot>	
			</table>
		</div>
		{{/with}}
	</div>
</template>

<template name="editStProfile">
	<h5>Update Profile</h5><hr/>
	{{#autoForm schema="g.Schemas.UpdateStudent" id="editStProfile" type="normal" doc=currentStudent validation='blur'}}
		<div class="row">
			<div class="col-sm-12">
				<legend>Profile Information</legend><hr/>
			</div>	
			<div class="col-md-6">
				<fieldset>
					{{>afQuickField name="state" options="allowed"}}
					{{>afQuickField name="town"}}
					{{>afQuickField name="homeAddress"}}
					{{>afQuickField name="presentAddress"}}
					{{>afQuickField name="nok"}}
				</fieldset>
				
			</div>	
			<div class="col-sm-6">
				<fieldset>
					{{>afQuickField name="dob"}}
					{{>afQuickField name="phone"}}
					{{>afQuickField name="hobby"}}
					{{>afQuickField name="club" options="allowed"}}
					<!-- {{>afQuickField name="medicalHistory"}} -->
					{{>afQuickField name="medicalHistory.bloodGroup" options="allowed"}}
					{{>afQuickField name="medicalHistory.genotype" options="allowed"}}
					{{>afQuickField name="medicalHistory.medicalCondition" options="allowed" type="select-checkbox-inline"}}
				</fieldset>
			</div><br/>				
			<div class="form-group col-sm-12">
				<button type="submit" class="btn btn-primary">Update</button>	
			</div>
		</div>
	{{/autoForm}}
</template>

<template name="stResult">
	<div class="row">
		<div class="col-sm-12">
			<h5>Student Results</h5><hr/>
			<form class='searchResult'>
				<select name="class">
				{{#if availableClass}}
					{{#each availableClass}}	
						<option value="{{this}}">{{this}}</option>
					{{/each}}
				{{/if}}
				</select>
				<select name="term">
					{{#each termArray}}
						<option value="{{this}}">{{termSuffix this}}</option>
					{{/each}}
				</select>
				<button type="submit" class="btn btn-primary btn-sm">Show result</button>
			</form><br/>
			{{#with currentStudent}}
				<table class="table table-responsive table-bordered">
					<tbody>
						<tr>
							<th>First Name</th>
							<td>{{firstName}}</td>
							<th>Other Name</th>
							<td>{{lastName}} {{otherName}}</td>
							<td rowspan="3">
								<img src="/student10.png" alt="{{studentId}} passport" style="max-width:50px">
							</td>
						</tr>
						<tr>
							<th>Student ID</th>
							<td>{{studentId}}</td>
							<th>Email</th>
							<td>{{email}}</td>
						</tr>
						<tr>
							<th>Current Class</th>
							<td>{{currentClass}}</td>
							<th>Current Term</th>
							<td>{{termSuffix setting.term}}</td>
						</tr>
					</tbody>
				</table>
			{{/with}}
			{{#with studentRes}}
				<table class="table table-responsive table-striped table-bordered">
					<thead>
						<tr>
							<th colspan="7" class="table-info">Result details</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<th>Class</th> <td>{{class}}</td>
							<th>Term</th> <td>{{termSuffix term}}</td>
							<th>Session</th><td>{{session}}</td>
						</tr>
					</tbody>
				</table>
				<table class="table table-responsive table-striped table-bordered serial">
					<thead>
						<tr>
							<th>#</th>
							<th>Subjects</th>
							<th>CA</th>
							<th>Exam</th>
							<th>Total</th>
							<th>Grade</th>
							<th>Remark</th>
						</tr>
					</thead>
					<tbody>
						{{#each resultObjectToArray studentRes}}
						<tr>
							<th></th>
							<td>{{this.name}}</td>
							<td>{{this.value.ca}}</td>
							<td>{{this.value.exam}}</td>
							<td>{{this.value.total}}</td>
							<td>{{this.value.grade}}</td>
							<td>{{this.value.remark}}</td>
						</tr>
						{{/each}}
					</tbody>
				</table><br/>
				<button class="btn btn-danger btn-lg" onclick="window.print()">Print</button>
			{{else}}
				{{#with getSession "stRequestedResult"}}
					<h5 class="text-info text-center">
						No result found for {{class}} term {{term}}.
					</h5>
				{{else}}
					<h5 class="text-danger text-center">
						Result not yet available for term {{setting.term}}
					</h5>
				{{/with}}
			{{/with}}
		</div>
	</div>	
</template>

<template name="stPayment">
		<h5>Student Payments</h5><hr/>
		<div class="row">
			<div class="col-sm-12">
			{{#if pendingPayment}}
				<p class="alert alert-warning">This term school fees payment is pending &nbsp;&nbsp; <a href="{{pathFor 'stNewPayment'}}" class="btn btn-success btn-sm">Pay now</a></p>
			{{/if}}
		</div>
			<div class="col-sm-12">
				<form class='searchPayment'>
					<select name="class">
					{{#if availableClass}}
						{{#each availableClass}}
							<option value="{{this}}">{{this}}</option>
						{{/each}}
					{{/if}}
					</select>
					<select name="term">
						{{#each termArray}}
							<option value="{{this}}">{{termSuffix this}}</option>
						{{/each}}
					</select>
					<button type="submit" class="btn btn-primary btn-sm">Show payment</button>
				</form><br/>
				{{#with currentStudent}}
					<table class="table table-responsive table-bordered">
					<tbody>
						<tr>
							<th>First Name</th>
							<td>{{firstName}}</td>
							<th>Other Name</th>
							<td>{{lastName}} {{otherName}}</td>
							<td rowspan="3">
								<img src="/student10.png" alt="{{studentId}} passport" style="max-width:50px">
							</td>
						</tr>
						<tr>
							<th>Student ID</th>
							<td>{{studentId}}</td>
							<th>Email</th>
							<td>{{email}}</td>
						</tr>
						<tr>
							<th>Current Class</th>
							<td>{{currentClass}}</td>
							<th>Current Term</th>
							<td>{{termSuffix setting.term}}</td>
						</tr>
					</tbody>
					</table>
				{{/with}}
			</div>
			<div class="col-sm-8">
				{{#with studentPay}}
					<table class="table table-responsive table-striped table-bordered">
						<thead>
							<tr>
								<th colspan="2" class="table-info">Payment details</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Class</td>
								<td>{{class}}</td>
							</tr>
							<tr>
								<td>Term</td>
								<td>{{termSuffix term}}</td>
							</tr>
							<tr>
								<td>Session</td>
								<td>{{session}}</td>
							</tr>
							<tr>
								<td>Payment Category</td>
								<td>{{category}}</td>
							</tr>
							<tr>
								<td>Amount</td>
								<td>{{amount}}</td>
							</tr>
							<!-- online payment -->
							<!-- {{#if paymentMethod paymentType}} -->
							<tr>
								<td>Amount Approved</td>
								<td>{{approvedAmount}}</td>
							</tr>
							<tr>
								<td>Gateway Description</td>
								<td>{{paymentDescription}}</td>
							</tr>
							<tr>
								<td>Payment Reference</td>
								<td>{{payRef}}</td>
							</tr>
							<!-- {{/if}} -->
							<!-- end online payment fields -->
							<tr>
								<td>Payment Method</td>
								<td>{{paymentType}}</td>
							</tr>
							<tr>
								<td>Payment Status</td>
								<td>{{paymentStatus}}</td>
							</tr>
							<tr>
								<td>Payment Date</td>
								<td>{{dateFormat date}}</td>
							</tr>
							<tr>
								<td>Transaction ID</td>
								<td>{{transactionId}}</td>
							</tr>
							<tr>
								<td>Payer</td>
								<td>{{payerName}}</td>
							</tr>
							</tbody>
					</table>
					<br/>
					<button class="btn btn-danger" onclick="window.print()">Print</button>
				{{else}}
					{{#with getSession "stRequestedPayment"}}
						<h5 class="text-info text-center">Payment not yet made for {{class}} term {{term}}</h5>
					{{else}}
						<h5 class="text-info text-center">No payment found for term {{setting.term}}</h5>
					{{/with}}
				{{/with}}
			</div>	
		</div>
</template>
<template name="stNewPayment">
	<h5>New Payment</h5><hr/>
	<div class="row">
		<div class="col-sm-12">	
			<form id="createPaymentReceipt">
				<select name="paymentCat">
					{{#each PaymentCategory}}
						<option value="{{this}}">{{this}}</option>
					{{/each}}
				</select>
				<button type="submit" class="btn btn-primary btn-sm">Create receipt</button>
			</form>
			<p class="text-info">Select a payment category above before proceeding to the payment gateway.</p>
		</div>
		{{#with currentStudent}}
		<div class="col-sm-6">
			<img src="/student10.png" style="max-width:100px;margin:10px;">
			<table class="table table-responsive table-striped table-bordered table-sm">
				<tbody>
					<tr>
						<th>Name</th>
						<td>{{lastName}} {{firstName}} {{otherName}}</td>	
					</tr>
					<tr>
						<th>Student Id</th>
						<td>{{studentId}}</td>
					</tr>
					<tr>
						<th>Current class</th>
						<td>{{currentClass}}</td>
					</tr>
					<tr>
						<th>Current term</th>
						<td>{{termSuffix setting.term}}</td>
					</tr>
					<tr>
						<th>Payment category</th>
						<td>{{paymentInfo.paymentCategory}}</td>
					</tr>
					<tr>
						<th>Amount</th>
						<td>{{paymentInfo.amount}}</td>
					</tr>
					<tr>
						<th>Payment method</th>
						<td>Online</td>
					</tr>
				</tbody>
			</table>
			<p class="text-danger"><strong>
				Please note:</strong><br/>
				<span>Online payment will be processed by interswitch payment gateway.</span>
			</p>
			 {{#if paymentInfo.failedPaymentReason}}
				<p class="text-danger"><strong>Payment failed due to {{paymentInfo.failedPaymentReason}}. Try again!</strong></p>
			{{/if}}
			<div id="onlinePayment" style="display:none;">
				{{#with paymentInfo}}
					<a data-isw-payment-button data-isw-ref='kGM0Ul8XP'>
					  <script type='text/javascript' 
					    src='https://qa.interswitchng.com/paymentgateway/public/js/webpay.js' 
					    data-isw-customer-ref='{{transactionId}}' 
					    data-isw-customer-callback='cardPaymentCallback'
					    data-isw-trans-amount='{{amount}}00'> 
					  </script>
					</a>
				{{/with}}
					<script>
					  function cardPaymentCallback(response){
					  		if(!response){
						  		return;
						  	}
						  	console.log(response);
						  	let iswPayment = Session.get('stPaymentInfo'); 
							if(response.resp==="00" && response.desc=="Approved by Financial Institution" && response.payRef!==response.txnref){
								iswPayment.response = response;
								g.meteorCall("newPaymentByStudent",{doc:iswPayment,
									successMsg:"Payment was successful",
									redirect:"stPayment"
								});
							}else{
								iswPayment.failedPaymentReason = response.desc;
								Session.set("stPaymentInfo",iswPayment);
							}
					  }
					</script>
			</div>
		</div> 
			{{/with}}
	</div>
</template>
<template name="stAssignment">
	<h5>Assignment list</h5><hr/>
	<div class="row">
		<div class="col-sm-12">
			<form class="form-inline">
				<div class="form-group">
					<select name="subject" class="form-control">
						{{#each subjects}}
							<option value="{{this}}">{{this}}</option>
						{{/each}}
					</select> &nbsp;&nbsp;
					<button type="submit" class="btn btn-primary btn-sm">Filter assignment</button>
				</div>
			</form><br/>
			{{#each assignmentList}}
			<div class="row">		
				<div class="col-sm-2">
						<h6 class="">{{class}}</h6>
						<span class="badge badge-secondary">{{subject}}</span>
				</div>
				<div class="col-sm-10">
					<h6>
						<a href="{{pathFor 'stSingleAssignment'}}/{{_id}}">{{title}}</a>
						{{#if status}}
							<span class="badge badge-success">Answered</span>
						{{else}}
							<span class="badge badge-warning">Not Answered</span>
						{{/if}}	
						{{#if validity}}
							<span class="badge badge-danger">Expired</span>
						{{/if}}
						{{#if validity}}
						<span class="badge badge-danger">Closed</span>
						{{/if}}
					</h6>
					<span class="badge badge-info">Start: {{dateFormat startDate}}</span>
					<span class="badge badge-info">Due date: {{dateFormat endDate}}</span>
					<span class="badge badge-info">Max score: {{totalScore}}</span>
				</div>
			</div><hr/>
			{{else}}
				{{#with getSession "assFilter"}}
					<h5 class="text-info">No assignment found for <em>{{getSession "assFilter"}}.</em></h5>
				{{else}}
					<h5 class="text-info">No assignment found for your class.</h5>
				{{/with}}
			{{/each}}
		</div>
	</div>			
</template>

<template name="stSingleAssignment">
	<div class="row">
		<div class="col-sm-12">
			{{#with assignment}}
				<h4>
					{{title}} 
					{{#if dueDate}}
						<span class="badge badge-danger">expired</span>
					{{/if}}
				</h4><hr/>
				{{#if stAnswer}}
					<span class="badge badge-success">Answered</span>
					{{#if stAnswer.score}}
						and 
						<span class="badge badge-success">marked</span><span class="fa fa-check fa-2x text-success"></span>
					{{/if}}
				{{else}}
					<span class="text-warning">Not Answered</span>
				{{/if}}
				<hr/>
				<article>
					<h5>Question</h5>
					<p>{{content}}</p>
					<span class="badge badge-info">Class: {{class}}</span>
					<span class="badge badge-info">Subject: {{subject}}</span>
					<span class="badge badge-info">Mark: {{totalScore}}</span>
					<span class="badge badge-info">Start date: {{dateFormat startDate}}</span>
					<span class="badge badge-info">End date: {{dateFormat endDate}}</span>
					<br/>
					<p>
						Posted by: <strong>{{author}}</strong> 
					</p>
					<p>
						{{#if dueDate}}
							<p class="text-danger">Assignment has expired.</p>
						{{/if}}
					</p>
					<hr/>
					{{#if stAnswer}}
						<p><strong>Your submitted answer</strong></p>
						{{#with stAnswer}}
							<p>{{text}}</p>
							<p><span>
							<strong>Score: </strong>
							{{#if score}} 
								{{score}} / {{assignment.totalScore}} <i class="fa fa-check fa-2x text-success"></i>
							{{else}} 
								Not scored
							{{/if}}
							</span></p>
							<p>
								<span>
								<strong>Comment: </strong>
								</span>
								{{#if comment}}
									<strong>{{comment}}</strong>
								{{else}}
									No comment
								{{/if}}
							</p>
							<span><strong>Submitted on:</strong> <span class="badge badge-secondary">{{dateFormat date}}</span></span>
						{{/with}}
					{{else}}
						{{#if dueDate}}
							<span class="fa fa-ban fa-2x"> Submission not allowed</span>
						{{else}}
							<p>Type your answer in the box below</p>
							<form class="answer form-group">
								<textarea name="answer" cols="45" rows="5" placeholder="Your answer here" class="form-control"></textarea><br/>

								<button type="submit" class="btn btn-success">Submit Answer</button>
							</form>
						{{/if}}
					{{/if}}
				</article>
			{{/with}}
		</div>
	</div>
</template>
		
<template name="stMessage">
	<div class="row">
		<div class="col-sm-12">
			<h3>Messages</h3><hr/>
		<!-- Nav tabs -->
			  <ul class="nav nav-tabs" role="tablist">
			    <li class="nav-item">
			    	<a href="#inbox" aria-controls="inbox" role="tab" data-toggle="tab" class="nav-link active" aria-expanded="true">Inbox Messages</a>
			    </li>
			    <li class="nav-item">
			    	<a href="#sent" aria-controls="sent" role="tab" data-toggle="tab" class="nav-link">Sent Messages</a>
			    </li>
			    <li class="nav-item">
			    	<a href="#newMessage" aria-controls="newMessage" role="tab" data-toggle="tab" class="nav-link">Compose New</a>
			    </li>
			  </ul>
			 <div class="tab-content">
			    <div role="tabpanel" class="tab-pane fade show active" id="inbox">
			    	{{> stInboxMessage}}
			    </div>
			    <div role="tabpanel" class="tab-pane fade" id="sent">
			    	{{> stSentMessage}}
			    </div>
			    <div role="tabpanel" class="tab-pane fade" id="newMessage">
			    	{{> stNewMessage}}
			    </div>
			 </div>
		</div>
	</div>
</template>
<template name="stInboxMessage">
	<div class="row">	
		<div class="col-sm-12">
			<br/>
			{{#with inboxCount}}
			<h5>
				<button class="btn btn-sm inboxBtn" title="Inbox messages">Inbox: <span class="badge badge-info">{{count}}</span>
				</button>
				<button class="btn btn-sm unreadBtn" title="Unread messages">Unread: <span class="badge badge-info">{{unread}}</span></button>
				<button class="btn btn-sm readBtn" title="Read messages"><i class="fa fa-check text-success"> </i>Read: <span class="badge badge-info">{{read}}</span></button>
			</h5>
			{{/with}}
		</div>
		<div class="col-sm-12">
			{{#if inboxMsg}}
				<table class="table table-responsive table-hover table-sm">
					<thead>
						<tr>
							<th></th>
							<th>Sender</th>
							<th>Subject</th>
							<th>Date received</th>
							<th>Action</th>
						</tr>	
					</thead>
					<tbody>
					{{#each inboxMsg}}
						<tr>
							<td>
								<span class="{{read}}"></span>
							</td>
							<td>{{senderName}}</td>
							<td>{{subject}} <span class="badge badge-success" title="Number of replies">{{count}}</span></td>
							<td>{{dateFormat createdAt}}</td>
							<td>
								<a href="{{pathFor 'stMessage'}}/{{_id}}" style="text-decoration: none;">
									<button class="btn btn-info btn-sm">Open</button>	
								</a>
								<button class="btn btn-danger btn-sm"><span class="fa fa-trash"></span> Delete</button>
							</td>
						</tr>
					{{/each}}
					</tbody>
				</table>
			{{else}}
				<h5 class="text-info">No message</h5>
			{{/if}}
		</div>
	</div>
</template>

<template name="stSentMessage">
	<div class="row">
		<div class="col-sm">
			<br/>
			<h5>
				<button class="btn btn-sm" title="Sent messages">Sent: <span class="badge badge-info">{{sentCount}}</span></button>
			</h5>
			{{#if sentMsg}}
				<table class="table table-responsive table-hover table-sm">
					<thead>
						<tr>
							<th></th>
							<th>Recipients</th>
							<th>Subject</th>
							<th>Date sent</th>
							<th>Action</th>
						</tr>
					</thead>
					<tbody>
					{{#each sentMsg}}
						<tr>
							<td>
								<input type="checkbox" name="id" value="{{_id}}">
							</td>
							<td>
								{{staffName}} {{studentName}}
							</td>
							<td>
								{{subject}} <span class="badge badge-success" title="Number of replies">{{count}}</span>
							</td>
							<td>
								{{dateFormat createdAt}}
							</td>
							<td>
								<a href="{{pathFor 'stMessage'}}/{{_id}}">
									<button class="btn btn-info btn-sm">Open</button>	
								</a>
								<button class="btn btn-danger btn-sm"><span class="fa fa-trash"></span> Delete</button>
							</td>
						</tr>
					{{/each}}
					</tbody>
				</table>
			{{else}}
				<h5 class="text-info">No sent messages</h5>
			{{/if}}
		</div>
	</div>
</template>
<template name="stSingleMessage">
	<div class="row">
		<div class="col-sm-12">
		{{#with message}}
			<h4>{{subject}}</h4><hr/>
			<span><b>Sender: </b>{{senderName}}</span><br/>
			<span><b>Receiver (Staff): </b><small>{{staffName}}</small></span><br/>
			<span><b>Receiver (Class): </b><small>{{toClass}}</small></span><br/>
			<span><b>Date: </b>{{dateFormat createdAt}}</span><br/>
			<span><b>Replies: </b>{{count}}</span><br/><hr/>
			<article style="padding:1em;line-height:2;">
				{{content}}
			</article>
		{{/with}}
		<form>
			<div class="form-group">
				<textarea class="form-control" placeholder="Reply to this message" minlength="5" rows="5" name="reply" required></textarea>
			</div>
			<button class="btn btn-primary btn-sm" type="submit">Submit reply</button>
		</form><br/>
		{{#if msgReply}}
			<h5>Replies <span class="badge badge-info" title="{{count}} replies">{{count}}</span></h5><hr/>
			{{#each msgReply}}
			<div class="reply">
				<p><span style="background-color: orangered; padding:2px;color:#fff;cursor:pointer;" title="commenter name"><strong>{{name}} </strong></span>
				<span title="Posted date"><strong> {{dateFormat replyDate}}</strong></span>

				</p>
				<p style="padding-left:2em;">{{reply}}</p>

			</div>
			<hr/>		
			{{/each}}
		
		{{else}}
			<h3>No Replies</h3>
		{{/if}}
		</div>
	</div>
</template>

<template name="stNewMessage">
	<div class="col-sm-10">
		<br/>
		<form>
			<label>Staff</label><br/>
			<div class="form-group">
				<select name="staff" class="form-control msgStaff">
					{{#each staff}}
						<option value="{{meteorIdInStaff}}">{{lastName}}, {{firstName}} {{otherName}}</option>
					{{/each}}
				</select>
			</div>
			<br/>
			<div class="form-group">
				<label for="title">Subject</label><br/>
				<input type="text" name="title" class="form-control" required placeholder="Subject of the message" maxlength="75" minlength="5">
			</div>
			<div class="form-group">
				<label for="content">Message body</label><br/>
				<textarea class="form-control" rows="6" required placeholder="Content of the message" name="body" minlength="10"></textarea>
			</div>

			<button type="submit" class="btn btn-primary">Send message</button>
		</form><br/>
	</div>
</template>

<template name="stLogs">
	<h5>Your activity log</h5><hr/>
	<div class="row">
		<div class="col-sm-12">
			<table class="table table-responsive table-bordered table-striped serial">
				<thead>
					<tr>
						<th>S/N</th>
						<th>Action</th>
						<th>Time</th>
					</tr>	
				</thead>
				<tbody>
				{{#each log}}
					<tr>
						<td></td>
						<td>{{name}} {{action}}</td>
						<td>{{dateFormat time}}</td>
					</tr>
				{{/each}}
				</tbody>
			</table>	
		</div>
	</div>
</template>